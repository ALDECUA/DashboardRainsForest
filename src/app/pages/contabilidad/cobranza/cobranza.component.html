<div class="page-container" [ngClass]="{'sidebar_is_full': app.sidebarState, 'sidebar_is_small': !app.sidebarState}">
  <!-- Content Wrapper START -->
  <div class="main-content">

    <div class="card">
      <div class="header-card">
        <h2>Pagos</h2>
      </div>
      <div class="card-body">
        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="pagadosrec" data-bs-toggle="pill" data-bs-target="#pagados_rec"
              type="button" role="tab" aria-controls="pagados_rec" aria-selected="true">Realizados</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="pendientesrec" data-bs-toggle="pill" data-bs-target="#pendientes_rec"
              type="button" role="tab" aria-controls="pendientes_rec" aria-selected="false">Pendientes</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="pills-contact-tab" data-bs-toggle="pill" data-bs-target="#pills-contact"
              type="button" role="tab" aria-controls="pills-contact" aria-selected="false">
              Rechazados
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="registrarrec" data-bs-toggle="pill" data-bs-target="#registrar_rec"
              type="button" role="tab" aria-controls="registrar_rec" aria-selected="false" 
              data-bs-toggle="modal"
              data-bs-target="#exampleModal">
              Registrar pago
            </button>
          </li>
        </ul>
        <div class="tab-content" id="pills-tabContent">
          <div class="tab-pane fade show active" id="pagados_rec" role="tabpanel" aria-labelledby="pagadosrec">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Inversionista</th>
                  <th scope="col">Desarrollo</th>
                  <th scope="col">Lote</th>
                  <th scope="col">Ultima fecha de pago</th>
                  <th scope="col">Concepto</th>
                  <th scope="col"></th>
                </tr>
              </thead>
              <tbody *ngFor="let registro of registros">
                <tr *ngIf="registro.IdStatus==1">


                  <td>{{registro.Nombre}}</td>
                  <td>{{registro.Desarrollo}}</td>
                  <td>{{registro.Lote}}</td>
                  <td>{{registro.FechaPago}}</td>
                  <td>{{registro.Concepto}}</td>
                  <td>
                    <button type="button" class="btn btn-outline-secondary"
                      (click)="verRecibo(registro.Img_Comprobante)"><i class="far fa-eye"></i></button>
                  </td>
                  <!-- <td><button class="btn btn-ico btn-sm btn-outline-success">Enviar recordatorio <i
                          class="fas fa-cloud-upload-alt"></i></button></td> -->

                </tr>
              </tbody>
            </table>
          </div>
          <div class="tab-pane fade" id="pendientes_rec" role="tabpanel" aria-labelledby="pendientesrec">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Inversionista</th>
                  <th scope="col">Desarrollo</th>
                  <th scope="col">Lote</th>
                  <th scope="col">Ultima fecha de pago</th>
                  <th scope="col">Concepto</th>
                  <th scope="col"></th>
                </tr>
              </thead>
              <tbody *ngFor="let registro of registros">
                <tr *ngIf="registro.IdStatus==2   ">

                  <td>{{registro.Nombre}}</td>
                  <td>{{registro.Desarrollo}}</td>
                  <td>{{registro.Lote}}</td>
                  <td>{{registro.FechaPago}}</td>
                  <td>{{registro.Concepto}}</td>
                  <td><button class="btn btn-ico btn-sm btn-outline-primary" (click)="ObtenerHr(registro)"
                      data-bs-toggle="modal" data-bs-target="#exampleModalToggle"><i
                        class="fas fa-check-circle me-2"></i>Detalles</button></td>
                </tr>
              </tbody>
            </table>
            <!-- modal example two -> multiple modal of two -->
            <div class="modal fade" id="exampleModalToggle" aria-hidden="true" aria-labelledby="exampleModalToggleLabel"
              tabindex="-1">
              <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalToggleLabel">Cliente: {{HR.Nombre}}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <div class="row">
                      <div class="col-md-6">
                        <button class="btn btn-img" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal"
                          data-bs-dismiss="modal">
                          <img class="img-compago"
                            src="{{app.dominio}}api/storage/comprobantes_pagos/{{HR.Img_Comprobante}}"
                            alt="{{HR.Img_Comprobante}}">
                        </button>
                        <button class="btn btn-outline-info" data-bs-target="#exampleModalToggle2"
                          data-bs-toggle="modal" data-bs-dismiss="modal"><i class="far fa-eye"></i></button>
                      </div>
                      <div class="col-md-6">
                        <ul class="list-group">
                          <li class="list-group-item">
                            <h4 class="fz-4 fw600">Desarrollo </h4>
                            <p>{{HR.Desarrollo}}</p>
                          </li>
                          <li class="list-group-item">
                            <h4 class="fz-4 fw600">Lote </h4>
                            <p>{{HR.Lote}}</p>
                          </li>
                          <li class="list-group-item">
                            <h4 class="fz-4 fw600">Importe </h4>
                            <p>{{HR.Importe}}</p>
                          </li>
                          <li class="list-group-item">
                            <h4 class="fz-4 fw600">Concepto </h4>
                            <p>{{HR.Concepto}}</p>
                          </li>
                          <li class="list-group-item">
                            <h4 class="fz-4 fw600">Fecha Pago </h4>
                            <p>{{HR.FechaPago}}</p>
                          </li>
                        </ul>

                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-danger" (click)="rechazarPago(HR)">Rechazar</button>
                    <button type="button" class="btn btn-success" (click)="registrarPago(HR)">Aceptar</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal fade" id="exampleModalToggle2" aria-hidden="true"
              aria-labelledby="exampleModalToggleLabel2" tabindex="-1">
              <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalToggleLabel2">Vista del comporbante de pago</h5>
                    <button class="btn btn-primary btn-back" data-bs-target="#exampleModalToggle" data-bs-toggle="modal"
                      data-bs-dismiss="modal"><i class="fas fa-sign-out-alt"></i></button>
                  </div>
                  <div class="modal-body">
                    <div class="row">
                      <div class="col-12">
                        <img class="img-compago"
                          src="{{app.dominio}}api/storage/comprobantes_pagos/{{HR.Img_Comprobante}}"
                          alt="{{HR.Img_Comprobante}}">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Inversionista</th>
                  <th scope="col">Desarrollo</th>
                  <th scope="col">Lote</th>
                  <th scope="col">Ultima fecha de pago</th>
                  <th scope="col">Concepto</th>
                </tr>
              </thead>
              <tbody *ngFor="let registro of registros">
                <tr *ngIf="registro.IdStatus==3">
                  <td>{{registro.Nombre}}</td>
                  <td>{{registro.Desarrollo}}</td>
                  <td>{{registro.Lote}}</td>
                  <td>{{registro.FechaPago}}</td>
                  <td>{{registro.Concepto}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Content Wrapper END -->
  <!-- Footer START -->
  <app-footer></app-footer>
  <!-- Footer END -->

</div>

<div
class="modal fade"
id="exampleModal"
tabindex="-1"
aria-labelledby="exampleModalLabel"
aria-hidden="true"
>
<div class="modal-dialog">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="exampleModalLabel">Registrar pago</h5>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="modal"
        aria-label="Close"
      ></button>
    </div>
    <div class="modal-body">
      <label>Selecciona un inversionista</label>
      <select
        [(ngModel)]="IdPersonaa"
        (change)="BuscarLotes()"
        class="form-control"
        id="datalistOptions"
      >
        <option value="null" selected disabled>
          Selecciona una opción
        </option>
        <option *ngFor="let item of personas" [value]="item.IdPersona">
          {{ item.Nombre }}
        </option>
      </select>
      <label>Selecciona un lote</label>
      <select
        [(ngModel)]="IdHR"
        class="form-control"
        id="datalistOptions"
        (change)="Ref($event)"
      >
        <option value="null" selected disabled>
          Selecciona una opción
        </option>
        <option *ngFor="let item of Lotes" [value]="item.IdHR">
          {{ item.Desarrollo }} Lote - {{ item.Lote }}
        </option>
      </select>
      <label>Concepto</label>
      <select
        (change)="concepto()"
        [(ngModel)]="Concepto"
        class="form-control"
        id="datalistOptions"
      >
        <option value="null" selected disabled>
          Selecciona una opción
        </option>
        <option value="2">Enganche</option>
        <option value="3">Gasto Administrativo</option>
        <option value="4">Mensualidad</option>
        <option value="5">Pago Generico</option>
        <option value="6">Intereses</option>
        <option value="7">Pago de contado</option>
      </select>
      <label>Tipo de pago</label>
      <select
        [(ngModel)]="tipopago"
        class="form-control"
        id="datalistOptions"
      >
      <option value="null" disabled>Selecciona una opción</option>
      <option value="2">Transferencia</option>
      <option value="3">Cheque</option>
      <option value="4">Efectivo</option>
      </select>
      <div *ngIf="Concepto == 4">
        <label>Numero de registros</label>
        <input type="number" min="1" class="form-control" [(ngModel)]="rep" />
      </div>
        <label>Monto</label>
        <input type="number" min="1" class="form-control" [(ngModel)]="montopagos" />
        <label>Fecha pago</label>
        <input type="date"  class="form-control" [(ngModel)]="fechapago" />
        <label>Comprobante</label>
        <div class="position-relative">
        <input [ngClass]="{disabled: !IdPersonaa}"  type="file" style="display: inline;" class="form-control" (change)="subirImagen(imagen.files)" name="imagen" #imagen> <br>
                      <div *ngIf="!IdPersonaa" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Tooltip on bottom" class="position-absolute bloqueo"></div>

      </div>
      </div>

    <div class="modal-footer">
      <button type="button" placeholder="Ingrese el monto" (click)="RegistrarPagos()" class="btn btn-primary">Registrar pago<label for="" *ngIf="rep > 1">s</label> </button>
    </div>
  </div>
</div>
</div>