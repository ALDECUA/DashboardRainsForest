<div class="page-container" [ngClass]="{'sidebar_is_full': app.sidebarState, 'sidebar_is_small': !app.sidebarState}">
    <!-- Content Wrapper START -->
    <div class="main-content">
        <div class="container">
            <app-navbar></app-navbar>
            <div class="row">
                <nav>
                    <div class="nav nav-tabs" id="nav-tab" role="tablist">
                        <button class="nav-link active" id="nav-prospectos-tab" data-bs-toggle="tab"
                            data-bs-target="#nav-prospectos" type="button" role="tab" aria-controls="nav-prospectos"
                            aria-selected="true">Prospectos</button>

                        <button class="nav-link position-relative" id="nav-seguimiento-tab" data-bs-toggle="tab"
                            data-bs-target="#nav-seguimiento" type="button" role="tab" aria-controls="nav-seguimiento"
                            aria-selected="false" (click)="recargarSeguimiento()">
                            Seguimiento
                            <span *ngIf="numeroLeads > 0"
                                class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-primary">
                                + {{numeroLeads}}
                            </span>
                        </button>
                    </div>
                </nav>

                <div class="tab-content" id="nav-tabContent">
                    <!-- Tab Prospectos -->
                    <div class="tab-pane fade show active" id="nav-prospectos" role="tabpanel"
                        aria-labelledby="nav-prospectos-tab">
                        <!-- <div class="col-md-12 mb-5"> -->
                        <div class="card">
                            <!-- <h1 class="card-header">Prospectos</h1> -->

                            <div class="card-body">
                                <div>
                                    <div class="text-center" id="loader"></div>
                                </div>
                                <!-- <button class="btn btn-primary" (click)="imprimirArray()">Ver</button> -->
                                <div class="d-flex justify-content-start align-items-center" style="padding: 0 1rem;">
                                    <input type="checkbox" id="allcb" (change)="checkAll($event)"
                                        style="width: 1.5rem; height: 1.5rem; margin: 1rem 0;">
                                    <button *ngIf="c > 0" class="btn btn-secondary btn-circle btn-xl ms-3" type="button"
                                        data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample2"
                                        aria-controls="offcanvasExample" (click)="imprimirArray()">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <button class="btn btn-secondary btn-circle btn-xl ms-3" type="button"
                                        (click)="recargarProspectos()">
                                        <i class="fas fa-redo"></i>
                                    </button>
                                </div>

                                <div class="table-responsive">
                                    <table id="table_prospectos" class="table table-striped table-hover prospect">
                                        <thead class="sticky-top">
                                            <tr>
                                                <th class="text-center">
                                                    <!--<i class="fa fa-check"></i>-->
                                                </th>
                                                <th style="display: none;" scope="col" class="numeration">#</th>
                                                <th class="name">Prospecto</th>
                                                <th>Email</th>
                                                <th>Telefono</th>
                                                <th>Fecha</th>
                                                <th>Plataforma</th>
                                                <!-- <th class="text-center align-middle"> -->
                                                <!-- <input type="checkbox" id="allcb" (change)="checkAll($event)" style="width: 1.5rem; height: 1.5rem;"> -->
                                                <!-- <mat-checkbox class="example-margin" color="primary" id="allcb" (change)="checkAll($event)"></mat-checkbox> -->
                                                <!-- </th> -->
                                                <th><i class="fas fa-cog"></i></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngIf="loadSpinner == true">
                                                <td colspan="8">
                                                    <div class="text-center">
                                                        <div class="spinner-border" style="width: 3rem; height: 3rem;">
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                            
                                            <tr class="table-secondary" *ngFor="let item of Prospectos;"
                                                id="{{item.Idlead}}">
                                                <td *ngIf="item.IdStatusCrm === 2" class="text-center align-middle">
                                                    <input type="checkbox" (click)="asignarCheck($event)" id="cb"
                                                        style="width: 1.5rem; height: 1.5rem;">
                                                    <!-- <mat-checkbox class="example-margin" color="primary" id="cb" style="width: 1.5rem !important; height: 1.5rem !important;"></mat-checkbox> -->
                                                </td>
                                                <th style="display: none;" scope="row" class="numeration" id="idLead"
                                                    *ngIf="item.IdStatusCrm === 2">{{item.Idlead}}</th>
                                                <td class="name" *ngIf="item.IdStatusCrm === 2">{{ item.Fullname }}</td>
                                                <td *ngIf="item.IdStatusCrm === 2">{{ item.Email }}</td>
                                                <td *ngIf="item.IdStatusCrm === 2">{{ item.Telefono }}</td>
                                                <td *ngIf="item.IdStatusCrm === 2">{{ item.Tiempo }}</td>
                                                <td *ngIf="item.IdStatusCrm === 2"> {{item.Plataforma}} </td>
                                                <td *ngIf="item.IdStatusCrm === 2">
                                                    <div class="dropdown">
                                                        <button class="btn btn-secondary table-btn dropdown-toggle"
                                                            type="button" data-bs-toggle="offcanvas"
                                                            data-bs-target="#offcanvasExample"
                                                            aria-controls="offcanvasExample"
                                                            (click)="seguimiento(item)">
                                                            <i class="fas fa-ellipsis-v"></i>
                                                        </button>
                                                    </div>
                                                    <!-- <div class="dropdown">
                                                            <button class="btn btn-secondary table-btn dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="fas fa-ellipsis-v"></i>
                                                            </button>
                                                            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                                                <li>
                                                                    <a class="dropdown-item" id="{{ item.Idlead }}" (click)="seguimiento(item)" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample">
                                                                        Agregar seguimiento
                                                                    </a>
                                                                </li>
                                                                <li>
                                                                    <a class="dropdown-item" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample">
                                                                        Reasignar
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </div> -->
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!-- </div> -->
                    </div>

                    <!-- Tab Seguimiento -->
                    <div class="tab-pane fade" id="nav-seguimiento" role="tabpanel"
                        aria-labelledby="nav-seguimiento-tab">
                        <div class="card">
                            <div class="card-body">
                                <!-- <div class="d-flex justify-content-start align-items-center">
                                    <button class="btn btn-secondary btn-circle btn-xl ms-3 mb-3" type="button"
                                        (click)="recargarSeguimiento()">
                                        <i class="fas fa-redo"></i>
                                    </button>
                                    <p *ngIf="numeroLeads > 0" class="ms-3 text-primary">Se encontraron nuevos leads asignados. Recargue la tabla para poder visualizarlos.</p>
                                </div> -->
                                <div class="row mb-2">
                                    <div class="col">
                                      <button type="button" class="btn btn-outline-warning" (click)="mesAnterior()">Mes Anterior</button>
                                    </div>
                                    <div class="col">
                                      <button type="button" class="btn btn-outline-warning" (click)="mesActual()">Mes Actual</button>
                                    </div>
                                </div>

                                <div class="table-responsive">
                                    <table class="table table-striped table-hover prospect">
                                        <thead class="sticky-top">
                                            <tr>
                                                <th>Nombre</th>
                                                <th>Fecha</th>
                                                <th>Paso 1</th>
                                                <th>Paso 2</th>
                                                <th>Paso 3</th>
                                            </tr>
                                        </thead>

                                        <tbody>
                                            <tr *ngIf="spinnerSeguimientos == true">
                                                <td colspan="5">
                                                    <div class="text-center">
                                                        <div class="spinner-border" style="width: 3rem; height: 3rem;">
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr *ngIf="leadsObtenidos.length === 0 && spinnerSeguimientos == false">
                                                <td colspan="8">
                                                    <div class="text-center">
                                                        <p>No hay leads en seguimiento ...</p>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr *ngFor="let lead of leadsObtenidos">
                                                <td>{{lead.Fullname}}</td>
                                                <td>{{lead.Fecha}}</td>
                                                <td *ngIf="lead.PasosLeads != null; else Paso"><i
                                                        class="fas fa-check text-success"></i></td>
                                                <ng-template #Paso>
                                                    <td><i class="fas fa-times text-danger"></i></td>
                                                </ng-template>
                                                <td></td>
                                                <td></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- <div class="row mt-5">
                <div class="col-lg-3 col-md-6 col-12 mb-5">
                    <div class="card">
                        <div class="card-header">
                            # de actividades
                        </div>
                        <div class="card-body">
                            <div class="chart"></div>
                            <div class="grupos">
                                <div class="ul">
                                    <li>Llamadas</li>
                                    <li>Anotaciones</li>
                                    <li>Emails</li>
                                    <li>SMS</li>
                                    <li>WhatsApp</li>
                                    <li>Citas</li>
                                    <li>Visitas</li>
                                    <li>Recordatorios</li>
                                    <li>Tareas</li>
                                    <li>Cotizaciones</li>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <p>Muestra el volumen de las actividades que se realizan</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6 col-12 mb-5">
                    <div class="card">
                        <div class="card-header">
                            Leads contactados por mes - Fecha Mes -
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">Grupo</th>
                                            <th scope="col">Cantidad</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <th scope="row">Pendientes</th>
                                            <td>100</td>

                                        </tr>
                                        <tr>
                                            <th scope="row">Contactados</th>
                                            <td>42</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">No les interesa</th>
                                            <td>10</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div> -->
            <!-- <div class="col-lg-3 col-sm-6 mb-5">
                    <div class="card text-white bg-info">
                        <div class="card-body">
                            <div class="text-value">100</div>
                            <div>Twitter</div>
                            <div class="mt-3 mb-3"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="card text-white bg-primary">
                        <div class="card-body">
                            <div class="text-value">100</div>
                            <div>Facebook</div>
                            <div class="mt-3 mb-3"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6 mb-5">
                    <div class="card text-white bg-warning">
                        <div class="card-body">
                            <div class="text-value">Instagram</div>
                            <div>Twitter</div>
                            <div class="mt-3 mb-3"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="card text-white bg-danger">
                        <div class="card-body">
                            <div class="text-value">100</div>
                            <div>LinkedIn</div>
                            <div class="mt-3 mb-3"></div>
                        </div>
                    </div>
                </div> -->
            <!-- </div> -->
            <!-- <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            Trafico y ventas
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="callout callout-info">
                                                <small class="text-muted">Nuevos Clientes</small>
                                                <br>
                                                <strong class="h4">120</strong>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="callout callout-info">
                                                <small class="text-muted">Clientes Contactados</small>
                                                <br>
                                                <strong class="h4">120</strong>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="progress-group">
                                        <div class="progress-pretended">
                                            Lunes
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-bar mt-1">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-danger" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-pretended">
                                            Martes
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-bar mt-1">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-danger" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-pretended">
                                            Miercoles
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-bar mt-1">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-danger" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-pretended">
                                            Jueves
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-bar mt-1">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-danger" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-pretended">
                                            Viernes
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-bar mt-1">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-danger" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-pretended">
                                            Sabado
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-bar mt-1">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-danger" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-pretended">
                                            Domingo
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-bar mt-1">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-danger" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="callout callout-info">
                                                <small class="text-muted">Pagados</small>
                                                <br>
                                                <strong class="h4">120</strong>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="callout callout-info">
                                                <small class="text-muted">Organicos</small>
                                                <br>
                                                <strong class="h4">120</strong>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="progress-group">
                                        <div class="progress-header">
                                            <i class="fas fa-male"></i>
                                            <div>Hombre</div>
                                            <div>50 %</div>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="progress-header">
                                            <i class="fas fa-female"></i>
                                            <div>Mujer</div>
                                            <div>50 %</div>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress" style="height: 5px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->

            <!-- OFFCANVAS -->
            <div class="offcanvas offcanvas-start w-50" tabindex="-1" id="offcanvasExample"
                aria-labelledby="offcanvasExampleLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasExampleLabel">Asignacion de leads</h5>
                    <button id="offcanvasButton" type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"
                        aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <div class="col-md-12">
                        <p><strong>Nombre:</strong> {{DataLead.Fullname}}</p>
                        <p><strong>Email:</strong> {{DataLead.Email}}</p>
                        <p><strong>Telefono:</strong> {{DataLead.Telefono}}</p>
                    </div>
                    <hr>
                    <h2>Asignar el lead al Socio Comercial</h2>
                    <div class="row g-3">
                        <div class="col-md-12">
                            <label for="inputState" class="form-label">Socio Comercial</label>
                            <select id="inputState" class="form-select" (change)="changed($event)"
                                [(ngModel)]="sociocid.id">
                                <option value="" selected>Selecciona un socio comercial</option>
                                <option value="{{item.IdPersona}}" *ngFor="let item of SociosComerciales">
                                    {{item.Nombre_completo}}</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <button class="btn btn-success" (click)="asignarLead()">Asignar</button>
                        </div>
                        <div class="col-12 mt-3 text-center" *ngIf="leadAsignado == true">
                            <div class="spinner-border" style="width: 3rem; height: 3rem;" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

       
            <div class="offcanvas offcanvas-start w-50" tabindex="-1" id="offcanvasExample2"
                aria-labelledby="offcanvasExampleLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasExampleLabel">Asignacion de leads</h5>
                    <button id="offcanvasButton2" type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"
                        aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <div class="col-md-12">
                        <p>Los Leads seleccionados se asignarán al siguiente Socio Comercial</p>
                    </div>
                    <hr>
                    <h2>Asignar el lead al Socio Comercial</h2>
                    <div class="row g-3">
                        <div class="col-md-12">
                            <label for="inputState" class="form-label">Socio Comercial</label>
                            <select id="inputState" class="form-select" (change)="changed($event)"
                                [(ngModel)]="sociocid.id">
                                <option value="" selected>Selecciona un socio comercial</option>
                                <option value="{{item.IdPersona}}" *ngFor="let item of SociosComerciales">
                                    {{item.Nombre_completo}}</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <button class="btn btn-success" (click)="asignarLead()">Asignar</button>
                        </div>
                       
                        <div class="col-12 mt-3 text-center" *ngIf="leadAsignado == true">
                            <div class="spinner-border" style="width: 3rem; height: 3rem;" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>